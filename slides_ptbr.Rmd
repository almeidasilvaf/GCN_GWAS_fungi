---
title: "Prioriza√ß√£o de genes de resist√™ncia a fungos em soja por meio da integra√ß√£o de associa√ß√£o gen√¥mica ampla e redes de coexpress√£o g√™nica"
author: "Fabr√≠cio de Almeida Silva"
institute: "PGBV/UENF"
date: "Junho, 2021"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "assets/venanciolab-fonts.css", "assets/venanciolab.css"]
    self_contained: false
    seal: true
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "https://platform.twitter.com/widgets.js"
      navigation:
        scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE, 
  message = FALSE,
  echo = FALSE,
  fig.width = 7, fig.height = 2.5
)
options(htmltools.dir.version = TRUE)
```

```{r panels, echo=FALSE}
xaringanExtra::use_panelset()
```

background-image: url(figs/intro1.png)
background-position: 95% 50%
background-size: 45%

## Introdu√ß√£o

<br />

.pull-left[
Soja e economia: 2% do PIB .font80[(EMBRAPA, 2019)]


Bilh√µes de d√≥lares gastos anualmente no controle de doen√ßas .font80[(Osman et al., 2015)]
]

---

background-image: url(https://www.researchgate.net/profile/Martin-Heil-2/publication/258202582/figure/fig7/AS:271915302518812@1441841068064/Examples-of-common-fungal-diseases-of-plants-a-Rust-on-flax-Linum-usitatissimum-C_Q640.jpg)
background-position: 95% 50%
background-size: 45%

## Introdu√ß√£o

<br />

.pull-left[
Soja e economia: 2% do PIB .font80[(EMBRAPA, 2019)]

Bilh√µes de d√≥lares gastos anualmente no controle de doen√ßas .font80[(Osman et al., 2015)]

**Fungos fitopatog√™nicos** -  Perda de produtividade por:

1. Les√£o foliar

2. Apodrescimento de ra√≠zes

3. Danos a sementes

4. Morte

Agenda 2030: aumento sustent√°vel da produtividade

.footnote[Garc√≠a-Guzm√°n *et al.*, 2013]

]

---

background-image: url(figs/intro3.png)
background-position: 50% 45%
background-size: 70%

## Doen√ßas de soja

<br />

<br />

<br />

<br />

<br />

<br />

<br />

<br />

<br />

<br />

<br />

.center[Fungos e nematoides causam as maiores perdas de produtividade em planta√ß√µes de soja.]

.footnote[Bandara *et al.*, 2020]

---

background-image: url(figs/intro4.png)
background-position: 95% 50%
background-size: 50%

## Imunidade de plantas

<br />

.pull-left[

Corrida armamentista na defesa de plantas:

- Imunidade desencadeada por PAMPs

- Imunidade desencadeada por efetores

Muitos genes envolvidos:

1. Reconhecimento

2. Transdu√ß√£o de sinal com intercomunica√ß√£o

3. Produ√ß√£o de ROS e estresse oxidativo

4. Prote√≠nas de defesa (e.g., PRs)

5. Produ√ß√£o de barreiras mec√¢nicas

.footnote[Song *et al.*, 2020]

]

---

background-image: url(figs/gwas_example1.png)
background-position: 50% 60%
background-size: 90%


## Estudos de associa√ß√£o gen√¥mica ampla (GWAS)

<br />

Identifica√ß√£o de variantes gen√©ticas associadas a certo fen√≥tipo (*e.g.* resist√™ncia a uma doen√ßa).

---

background-image: url(figs/gwas_example2.png)
background-position: 50% 60%

## Estudos de associa√ß√£o gen√¥mica ampla (GWAS)

<br />

Identifica√ß√£o de variantes gen√©ticas associadas a certo fen√≥tipo (*e.g.* resist√™ncia a uma doen√ßa).


---

background-image: url(figs/gwas_example3.png)
background-position: 50% 60%


## Estudos de associa√ß√£o gen√¥mica ampla (GWAS)

<br />

Identifica√ß√£o de variantes gen√©ticas associadas a certo fen√≥tipo (*e.g.* resist√™ncia a uma doen√ßa).

---

## O problema de pesquisa

<br />

GWAS identificaram **SNPs causais** relacionados a resist√™ncia a doen√ßas f√∫ngicas, mas n√£o **genes causais**.

M√©todos atuais resultam em altas taxas de falso-positivos e falso-negativos.

<br />

```{r}
knitr::include_graphics("figs/gwas_problem_1.png")
```

**Problema:** muitos falso-negativos

---

## O problema de pesquisa

<br />

GWAS identificaram **SNPs causais** relacionados a resist√™ncia a doen√ßas f√∫ngicas, mas n√£o **genes causais**.

M√©todos atuais resultam em altas taxas de falso-positivos e falso-negativos.

<br />

```{r}
knitr::include_graphics("figs/gwas_problem_2.png")
```

**Problema:** muitos falso-positivos

---

## A poss√≠vel solu√ß√£o

<br />

V√©rtices representam genes e arestas representam os coeficientes de correla√ß√£o entre eles.

```{r echo=FALSE, out.width='75%', fig.align='center'}
knitr::include_graphics("figs/redes_example1.png")
```

Em larga escala, √© poss√≠vel detectar **m√≥dulos** de genes com fun√ß√µes similares.

---

## A poss√≠vel solu√ß√£o

```{r echo=FALSE, fig.align='center'}
suppressPackageStartupMessages(library(networkD3))
data("MisLinks")
data("MisNodes")
MisNodes$group <- 1
MisNodes$group[MisNodes$name == "Valjean"] <- 2
MisNodes$name[MisNodes$name == "Valjean"] <- "Guide"
cols <- JS('d3.scaleOrdinal().domain(["1", "2"]).range(["steelblue", "maroon"])')

forceNetwork(Links = MisLinks, Nodes = MisNodes,
            Source = "source", Target = "target",
            Value = "value", NodeID = "name",
            Group = "group", colourScale = JS(cols),
            opacity = 0.9, height=600, width=1200)
```

---

## Objetivo

<br />
.center[.font120[Identificar genes de soja relacionados √† resist√™ncia a doen√ßas f√∫ngicas comuns a partir da integra√ß√£o de GWAS e redes de coexpress√£o g√™nica]]

--

<br />
.font130[.brand-charcoal[.bold[Objetivos espec√≠ficos]]]

- Criar banco de dados de SNPs relacionados √† resist√™ncia a fungos em soja

- Identificar acessos no banco de germoplasma do USDA com o maior n√∫mero de alelos ben√©ficos

- Analisar o perfil transcricional de todos os genes candidatos para minerar os mais promissores

- Criar um banco de dados de candidatos promissores a genes de resist√™ncia contra fungos

- Identificar a quais vias metab√≥licas os genes est√£o associados

---

background-image: url(figs/old_methods1.png)
background-size: cover

## Metodologia

---

background-image: url(figs/old_methods2.png)
background-size: cover

## Metodologia

---

background-image: url(figs/old_methods3.png)
background-size: cover

## Metodologia

---

background-image: url(figs/package_logos.png)
background-position: 95% 50%
background-size: 40%

## Desenvolvimento de softwares


.pull-left[
.brand-charcoal[.font130[.bold[BioNERO:]]]

Pacote do R destinado a:
- pr√©-processamento de dados de express√£o
- infer√™ncia de redes de coexpress√£o g√™nica
- an√°lises funcionais.

<br/ >
.brand-charcoal[.font130[.bold[cageminer:]]]

Pacote do R destinado a: 
- integrar GWAS e redes de coexpress√£o para priorizar genes candidatos 

]

---

background-image: url(figs/project_workflow.png)
background-size: 100%
background-position: 50% 30%

## Metodologia

---

background-image: url(figs/frequency_of_snps_and_transcriptome_samples_overlap.png)
background-position: 95% 50%
background-size: 45% 90%


## Descri√ß√£o dos dados

<br />

.pull-left[
.brand-charcoal[.font130[.bold[Crit√©rio de filtragem:]]]

Uma esp√©cie deve ser representada por: 
- amostras de transcriptoma
- SNPs significativos
]

---

background-image: url(https://crop-protection-network.s3.amazonaws.com/articles/BSR-foliar-and-stem-symptoms-A.-sisson.jpg)
background-position: 95% 50%
background-size: 40%

## Descri√ß√£o dos dados

.pull-left[
5 fungos fitopatog√™nicos comuns:

- *Cadophora gregata:* causador da podrid√£o parda da haste da soja

.footnote[Fonte: Crop Protection Network]
]

---

background-image: url(https://bsppjournals.onlinelibrary.wiley.com/cms/asset/df052881-7bbb-4915-9a88-c4b74a28c9b4/ppa12532-fig-0001-m.jpg)
background-position: 95% 50%
background-size: 40%

## Descri√ß√£o dos dados

.pull-left[
5 fungos fitopatog√™nicos comuns:

- *Cadophora gregata:* causador da podrid√£o parda da haste da soja

- *Fusarium graminearum:* causador da fusariose

.footnote[Chiotta *et al.*, 2016]
]

---

background-image: url(https://bugwoodcloud.org/images/768x512/5465755.jpg)
background-position: 95% 50%
background-size: 40%

## Descri√ß√£o dos dados

.pull-left[
5 fungos fitopatog√™nicos comuns:

- *Cadophora gregata:* causador da podrid√£o parda da haste da soja

- *Fusarium graminearum:* causador da fusariose

- *Fusarium virguliforme:* causador da s√≠ndrome da morte s√∫bita

.footnote[Fonte: Daren Mueller]
]

---

background-image: url(https://phytus.s3.amazonaws.com/apps/clubephytus-api/midia/a/5fcdcbb8/thumbnail.jpg)
background-position: 95% 50%
background-size: 40%

## Descri√ß√£o dos dados

.pull-left[
5 fungos fitopatog√™nicos comuns:

- *Cadophora gregata:* causador da podrid√£o parda da haste da soja

- *Fusarium graminearum:* causador da fusariose

- *Fusarium virguliforme:* causador da s√≠ndrome da morte s√∫bita

- *Macrophomina phaseolina:* causador da podrid√£o de carv√£o

.footnote[Fonte: Elevagro]
]

---

background-image: url(https://www.agrolink.com.br/upload/problemas/Phakopsora_pachyrhizi57.jpg)
background-position: 95% 50%
background-size: 40%

## Descri√ß√£o dos dados

.pull-left[
5 fungos fitopatog√™nicos comuns:

- *Cadophora gregata:* causador da podrid√£o parda da haste da soja

- *Fusarium graminearum:* causador da fusariose

- *Fusarium virguliforme:* causador da s√≠ndrome da morte s√∫bita

- *Macrophomina phaseolina:* causador da podrid√£o de carv√£o

- *Phakopsora pachyrhizi:* causador da ferrugem asi√°tica

.footnote[Fonte: Agrolink]
]

---

background-image: url(figs/snp_circos.png)
background-position: 95% 95%
background-size: 55% 95%

## Descri√ß√£o dos dados

<br />

.pull-left-1[
SNPs est√£o localizados em regi√µes abundantes em genes.
]

---

## Descri√ß√£o dos dados

```{r fig1_snp_dist, out.width='900px', out.height='500px', fig.align='center'}
knitr::include_graphics("figs/snp_dist.png")
```

De modo geral, SNPs tendem a se concentrar em cromossomos especƒ©ficos.

---

## Descri√ß√£o dos dados

```{r fig1_snp_pos, out.width='900px', out.height='450px', fig.align='center'}
knitr::include_graphics("figs/snp_positions.png")
```

Maioria dos SNPs em regi√µes interg√™nicas.

---

## Extra√ß√£o de genes candidatos

<br />

```{r all_cand, out.width='900px', out.height='500px', fig.align='center'}
knitr::include_graphics("figs/simulation_genes_per_sliding_window.png")
```

---

## Prioriza√ß√£o de genes candidatos

```{r workflow_cageminer, echo=FALSE}
knitr::include_graphics("figs/workflow.png")
```

---

## Prioriza√ß√£o de genes candidatos

.pull-left[

<br />

- *Cadophora gregata:* **11** 

- *Fusarium graminearum:* **59** 

- *Fusarium virguliforme:* **191** 

- *Macrophomina phaseolina:* **8** 

- *Phakopsora pachyrhizi:* **3** 

Defesa **altamente esp√©cie-espec√≠fica**

]

.pull-right[
```{r venn, echo=FALSE}
knitr::include_graphics("figs/venn_diagram_candidates.png")
```
]

---

## Sele√ß√£o de genes mais promissores

<br />
Atribui√ß√£o de *scores* aos genes candidatos priorizados:

.font140[
$$S_i = r_{pb} \kappa$$
] 

.center[
onde:

$\kappa$ = 2 se o gene for um fator de transcri√ß√£o

$\kappa$ = 2 se o gene for um *hub* (muito conectado)

$\kappa$ = 3 se o gene for um fator de transcri√ß√£o e um *hub*

]

---

## Sele√ß√£o de genes mais promissores

```{r genes_promissores_tabela}
gene_role <- readr::read_csv(
  "data/top_candidates_and_role.csv"
)
```

.panelset[
.panel[.panel-name[C. gregata]
```{r cgregata_genetable}
suppressPackageStartupMessages(library(formattable))
cgregata <- gene_role[gene_role$`Resistance to` == "C. gregata", -3]
formattable(cgregata, align=c('l', 'l', 'l'))
```
]
.panel[.panel-name[F. graminearum]
```{r fgraminearum_genetable}
fgraminearum <- gene_role[gene_role$`Resistance to` == "F. graminearum", -3]
formattable(fgraminearum, align=c('l', 'l', 'l'))
```
]
.panel[.panel-name[F. virguliforme]
```{r fvirguliforme_genetable}
fvirguliforme <- gene_role[gene_role$`Resistance to` == "F. virguliforme", -3]
formattable(fvirguliforme, align=c('l', 'l', 'l'))
```
]
.panel[.panel-name[M. phaseolina]
```{r mphaseolina_genetable}
mphaseolina <- gene_role[gene_role$`Resistance to` == "M. phaseolina", -3]
formattable(mphaseolina, align=c('l', 'l', 'l'))
```
]
.panel[.panel-name[P. pachyrhizi]
```{r ppachyrhizi_genetable}
ppachyrhizi <- gene_role[gene_role$`Resistance to` == "P. pachyrhizi", -3]
formattable(ppachyrhizi, align=c('l', 'l', 'l'))
```
]
]

---

background-image: url(figs/biorender_figure.png)
background-size: 85% 85%
background-position: 50% 90%

.center[
.red[*C. gregata*] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
.blue[*F. graminearum*] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
.brown[*F. virguliforme*] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
.green[*M. phaseolina*] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
.purple[*P. pachyrhizi*]
]

---

## PAV no pangenoma de soja

De modo geral, genes presentes em todos os 205 genomas.

```{r pav, out.width='75%'}
suppressPackageStartupMessages(library(ggiraph))
suppressPackageStartupMessages(library(tidyverse))
load(here::here("data", "pav_pangenome_table.rda"))
colnames(freq_table)[1] <- "Gene"
pav_plot_int <- freq_table %>%
    arrange(Species, -Mean) %>%
    mutate(index=1:nrow(freq_table)) %>%
    ggplot(., aes(x=index, y=Mean)) +
    geom_point_interactive(aes(tooltip=Gene, color=Species), size=1) +
    ggsci::scale_color_aaas() +
    theme_classic() +
    labs(title="PAV of mined candidate genes in the soybean pangenome",
         x="Gene index", y="Relative frequency") +
    theme(legend.position="bottom")
girafe(code = print(pav_plot_int), height_svg = 4, width_svg = 8)
```

---

## PAV no pangenoma de soja

```{r pangenome_paper1, fig.align='center', out.width='75%'}
knitr::include_graphics("figs/pangenome_paper_cover.png")
```

```{r pangenome_paper2, fig.align='center', out.width='75%'}
knitr::include_graphics("figs/pangenome_paper_highlight.png")
```

---

## Sele√ß√£o de cultivares de interesse

<br />

**Objetivo:** maior n√∫mero de alelos ben√©ficos e menor n√∫mero de alelos prejudiciais.

--

.pull-left[
.blue[.bold[A &rarr; G]] üëçüèº  

GG = 2

AG = 1

AA = 0

]

--

.pull-right[

.red[.bold[A &rarr; G]] üëéüèª  

GG = 0

AG = 1

AA = 2 

]

---

## Sele√ß√£o de cultivares de interesse

<br />

```{r cultivares, echo=FALSE, warning=FALSE, eval=FALSE}
suppressPackageStartupMessages(library(formattable))
acc <- read.csv("data/best_accessions_and_potential.txt", sep="\t")
acc2 <- acc[, c(4,1,3,2)]
acc2$Potential <- round(acc2$Potential, 2)
acc2$Score <- round(acc2$Score, 2)
formattable(acc2, 
            align = c("l", "l", "r", "r"),
            list(
              Potential = color_bar("lightblue")
              )
            )
``` 

.pull-left[
``` {r echo=FALSE, fig.align='right'}
knitr::include_graphics("figs/table1.png")
```
]

.pull-right[
``` {r echo=FALSE, fig.align='left'}
knitr::include_graphics("figs/table2.png")
```

]

Ainda h√° espa√ßo para piramidar alelos de resist√™ncia via MAS ou edi√ß√£o gen√¥mica

---

background-image: url(http://www.mcgilltribune.com/wp-content/uploads/2019/11/gene_editing.jpg)
background-position: 95% 50%
background-size: 40%

## Conclus√£o

.pull-left[
Identificamos genes candidatos promissores para desenvolver plantas de soja resistentes a 5 fungos fitopag√™nicos comuns por:

- Edi√ß√£o gen√¥mica

- Transgenia

.footnote[Fonte: The McGill Tribune]

]

---

background-image: url(https://www.agroscope.admin.ch/agroscope/en/home/topics/plant-production/plant-breeding/ackerpflanzen/selection_soja/_jcr_content/par/columncontrols/items/1/column/image/image.imagespooler.jpg/1473888418017/selection_soja_fleur.jpg)
background-position: 95% 50%
background-size: 40%

## Conclus√£o

.pull-left[
Identificamos genes candidatos promissores para desenvolver plantas de soja resistentes a 5 fungos fitopag√™nicos comuns por:

- Edi√ß√£o gen√¥mica

- Transgenia

Identificamos acessos mais resistentes do banco de germoplasma do USDA:

- Genitores em programas de melhoramento

- Editados com CRISPR-Cas para inserir os alelos faltantes

.footnote[Fonte: Agroscope]
]

---

background-image: url(figs/package_logos.png)
background-position: 95% 50%
background-size: 40%

## Conclus√£o

.pull-left[
Identificamos genes candidatos promissores para desenvolver plantas de soja resistentes a 5 fungos fitopag√™nicos comuns por:

- Edi√ß√£o gen√¥mica

- Transgenia

Identificamos acessos mais resistentes do banco de germoplasma do USDA:

- Genitores em programas de melhoramento

- Editados com CRISPR-Cas para inserir os alelos faltantes

Desenvolvemos 2 produtos (pacotes do R) que podem ser usados para identificar candidatos para outras caracter√≠sticas.
]
